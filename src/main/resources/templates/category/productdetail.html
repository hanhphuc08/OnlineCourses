<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="">
<meta name="author" content="">
<title>Online Course</title>

<!-- Google fonts-->
<link rel="stylesheet"
	href="https://fonts.googleapis.com/css2?family=Libre+Franklin:wght@300;400;700&amp;display=swap">
<link rel="stylesheet"
	href="https://fonts.googleapis.com/css2?family=Martel+Sans:wght@300;400;800&amp;display=swap">
<link rel="stylesheet"
	th:href="@{https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css}"
	integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2Lw=="
	crossorigin="anonymous" referrerpolicy="no-referrer" />
<!-- CSS files -->
<link rel="stylesheet"
	th:href="@{/vendor/bootstrap/css/bootstrap.min.css}">
<link rel="stylesheet" th:href="@{/assets/css/fontawesome.css}">
<link rel="stylesheet"
	th:href="@{/assets/css/style.default.7acfaf01.css}">
<link rel="stylesheet" th:href="@{/assets/css/custom.0a822280.css}">
<link rel="stylesheet"
	th:href="@{/assets/css/templatemo-space-dynamic.css}">
	
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</head>
<body>
	<!-- ***** Header Area Start ***** -->
	<div th:insert="~{decorators/headers :: header}"></div>
	<!-- ***** Header Area End ***** -->

	<!-- Fullscreen search area-->
	<div class="search-area-wrapper">
		<div
			class="search-area d-flex align-items-center justify-content-center">
			<div class="close-btn">
				<svg class="svg-icon svg-icon-light w-3rem h-3rem">
              <use xlink:href="#close-1"> </use>
            </svg>
			</div>
			<form class="search-area-form" action="#">
				<div class="mb-4 position-relative">
					<input class="search-area-input" type="search" name="search"
						id="search" placeholder="What are you looking for?">
					<button class="search-area-button" type="submit">
						<svg class="svg-icon">
                  <use xlink:href="#search-1"> </use>
                </svg>
					</button>
				</div>
			</form>
		</div>
	</div>
	<!-- /Fullscreen search area-->


	<!-- Section -->
	<section class="hero pt-7">
		<div class="container">
				<div th:if="${success}" class="alert alert-success" role="alert">
		            <span th:text="${success}"></span>
		        </div>
		        <div th:if="${error}" class="alert alert-danger" role="alert">
		            <span th:text="${error}"></span>
		        </div>
			<!-- Breadcrumbs -->
			<ol class="breadcrumb justify-content-left">
				<li class="breadcrumb-item"><i class="fas fa-home pe-sm-2"></i><a
					href="index.html">Trang chủ</a></li>
				<li class="breadcrumb-item">Danh mục khóa học</li>
				<li class="breadcrumb-item active" th:text = "${course != null ? course.title : 'Không tìm thấy khóa học'}"></li>
			</ol>

			<div th:if="${course != null}" class="row mb-5">
				<!-- Course Details -->
				<div class="col-lg-8 course-details-wrapper">
					<div class="cart">
						<div class="cart-wrapper">
							<div class="cart-header">
								<div class="row">
									<div class="col-12">
										<h5 class="mt-3 text-center" th:text="${course.title}">Tên khóa học</h5>
									</div>
								</div>
							</div>
						</div>
					</div>
					<ul class="nav nav-tabs mt-4 nav-tabs-custom" id="courseTabs"
						role="tablist">
						<li class="nav-item" role="presentation"><a
							class="nav-link active" id="content-tab" data-bs-toggle="tab"
							href="#content" role="tab" aria-controls="content"
							aria-selected="true">Nội dung</a></li>
						<li class="nav-item" role="presentation"><a class="nav-link"
							id="comments-tab" data-bs-toggle="tab" href="#comments"
							role="tab" aria-controls="comments" aria-selected="false">Bình
								luận</a></li>
						<li class="nav-item" role="presentation"><a class="nav-link"
							id="reviews-tab" data-bs-toggle="tab" href="#reviews" role="tab"
							aria-controls="reviews" aria-selected="false">Đánh giá</a></li>
					</ul>

					<!-- Tabs Content -->
					<!-- Tabs Content -->
					<div class="tab-content mt-3" id="courseTabsContent">
						<!-- Nội dung Tab -->
						<div class="tab-pane fade show active" id="content"
							role="tabpanel" aria-labelledby="content-tab">
							<div class="mt-4">
								<p th:text="${course.description ?: 'Chưa có mô tả khóa học'}">Mô tả khóa học</p>
								<div th:each="learningPath, iterStat : ${course.learningPaths}">
								<!--  <h5 class="text-danger" th:text="${learningPath.title}">Chuyên đề</h5> -->
								<ul class="list-unstyled">
									<li class="mb-3">
										<div class="d-flex align-items-center">
											<div>
												<strong><i class="fas fa-play-circle me-2"></i>
												<span th:text="${learningPath.title}">Tiêu đề nội dung</span>
												</strong>
												
											</div>
										</div>
									</li>
								</ul>
								
							</div>
							</div>
						</div>
						

						<!-- Bình luận Tab -->
						<div class="tab-pane fade" id="comments" role="tabpanel"
							aria-labelledby="comments-tab">
							<p class="text-muted mx-4">Chưa có bình luận nào cho khóa học
								này. Hãy là người đầu tiên để lại bình luận!</p>
						</div>

						<!-- Đánh giá Tab -->
						<div class="tab-pane fade" id="reviews" role="tabpanel"
							aria-labelledby="reviews-tab">
							<div class="rating-summary d-flex align-items-center">
								<div class="rating-score me-3 mx-6">
									<h1 class="text-danger mb-0">5.0</h1>
									<div>
										<i class="fas fa-star text-warning"></i> <i
											class="fas fa-star text-warning"></i> <i
											class="fas fa-star text-warning"></i> <i
											class="fas fa-star text-warning"></i> <i
											class="fas fa-star text-warning"></i>
									</div>
									<p class="text-muted mb-0">
										<i class="fas fa-user me-1"></i>đánh giá
									</p>
								</div>
								<div class="rating-distribution">
									<div class="d-flex align-items-center mb-1">
										<span class="me-2">5</span> <span
											class="rating-circle bg-success rating-custom">(0)</span>
									</div>
									<div class="d-flex align-items-center mb-1">
										<span class="me-2">4</span> <span
											class="rating-circle bg-success rating-custom">(0)</span>
									</div>
									<div class="d-flex align-items-center mb-1">
										<span class="me-2">3</span> <span
											class="rating-circle bg-warning rating-custom">(0)</span>
									</div>
									<div class="d-flex align-items-center mb-1">
										<span class="me-2">2</span> <span
											class="rating-circle bg-warning rating-custom">(0)</span>
									</div>
									<div class="d-flex align-items-center mb-1">
										<span class="me-2">1</span> <span
											class="rating-circle bg-danger rating-custom">(0)</span>
									</div>
								</div>
							</div>
							<!-- User Reviews Section -->
							<div class="user-reviews mt-4">
								<p class="text-muted mx-4">Chưa có đánh giá nào cho khóa học
									này. Hãy để lại đánh giá nếu bạn đã tham gia khóa học!</p>
								<div class="text-center mt-3">
									<a href="#" class="btn btn-primary mb-4">Viết đánh giá</a>
								</div>
							</div>
						</div>
						
					</div>
				</div>

				<!-- Sidebar with Course Summary -->
				<div class="col-lg-4" th:if="${course != null}">
					<div class="block mb-5">
						<div class="block-header">
							<h6 class="text-uppercase mb-0">Tổng quan khóa học:</h6>
						</div>
						<div class="block-body bg-light pt-2">
							<ul class="order-summary mb-0 list-unstyled">
								<li class="order-summary-item d-flex justify-content-between">
									<span>Học phí:</span>
									<span th:text = "${course.formattedPrice != null ? course.formattedPrice  : 'Chưa có thông tin cụ thể'}">1.500.000 VND</span>
								</li>
								<li class="order-summary-item d-flex justify-content-between">
									<span>Thời hạn khóa học:</span>
									<span th:text="${course.formattedDuration != null ? course.formattedDuration : 'Chưa có thông tin'}">Sau khi kết thúc kỳ thi THPT 2025</span>
								</li>
								<li class="d-flex justify-content-center align-items-center"
									th:if="${course != null and course.status != null and course.status == T(com.example.demo.model.courseStatus).ACTIVE}">
									<button th:onclick="|addToCart(event, ${course.courseID})|"
										class="btn btn-warning mt-4 mb-4 mx-2 text-white">Thêm
										vào giỏ hàng</button>
									<form
										th:action="@{/course/checkout/{id}(id=${course.courseID})}"
										method="post" style="display: inline;">
										<button type="submit" class="btn btn-success mt-4 mb-4 mx-2">Mua
											ngay</button>
									</form>
								</li>
								<li class="d-flex justify-content-center align-items-center"
									th:if="${course == null or course.status == null or course.status == T(com.example.demo.model.courseStatus).INACTIVE}">
									<p class="text-muted">Khóa học hiện không hoạt động</p>
								</li>
								
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>


	<!-- ***** Footer Area Start ***** -->
	<div th:insert="~{decorators/footers :: footer}"></div>
	<!-- ***** Footer Area End ***** -->

	<!-- Scripts -->
	<script th:src="@{/vendor/jquery/jquery.min.js}"></script>
	<script th:src="@{/vendor/bootstrap/js/bootstrap.bundle.min.js}"></script>
	<script th:src="@{/assets/js/wow.min.js}"></script>
	<script th:src="@{/assets/js/owl-carousel.js}"></script>
	<script th:src="@{/assets/js/animation.js}"></script>
	<script th:src="@{/assets/js/imagesloaded.js}"></script>
	<script th:src="@{/assets/js/custom.js}"></script>
	<script>
    function addToCart(event, courseId) {
        event.preventDefault();
        $.ajax({
            url: `/course/cart/add/${courseId}`,
            type: 'POST',
            data: { ajax: true },
            success: function (response) {
                console.log('AJAX response:', response);
                if (response.startsWith('success')) {
                    Swal.fire({
                        icon: 'success',
                        title: 'Thành công',
                        text: 'Đã thêm khóa học vào giỏ hàng!',
                    });
                } else {
                    Swal.fire({
                        icon: 'warning',
                        title: 'Thông báo',
                        text: response.split(': ')[1],
                    });
                }
            },
            error: function (xhr) {
                console.log('AJAX error:', xhr.status, xhr.responseText);
                const message = xhr.responseText.split(': ')[1] || 'Không thể thêm vào giỏ hàng. Vui lòng thử lại!';
                Swal.fire({
                    icon: 'error',
                    title: 'Lỗi',
                    text: message,
                });
                if (xhr.status === 401) {
                    setTimeout(() => window.location.href = '/login', 2000);
                }
            }
        });
    }

    function buyNow(event, courseId) {
        event.preventDefault();
        // Submit form for checkout
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = `/course/checkout/${courseId}`;
        document.body.appendChild(form);
        form.submit();
    }
</script>

</body>
</html>